# Проектная работа "web-larek-frontend"

## Используемый стек

HTML, SCSS, TypeScript в ООП-стиле. Webpack.

Структура проекта:

- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:

- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/scss/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск

Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```

## Сборка

```
npm run build
```

или

```
yarn build

```

## О проекте

Проект представляет собой приложение интернет-магазин для продажи цифровых товаров,
реализованное на TypeScript с использованием ООП-подхода и архитектуры MVP.

### Приложение включает в себя

- получение с сервера данных списка о продукции;
- просмотр каталога товаров;
- многоэтапное оформление заказа;
- управление корзиной;
- отправка данных о заказе на сервер;

### Бизнес логика

- добавление и удаление товара в корзину;
- выборр способа оплаты;
- ввод данных;
- валидация форм заказа;
- рассчёт общей стоимости;
- история заказов;
- покупка бесценных товаров;
- обработка ошибок API;

### Техническая реализация

- событийно-ориентированная архитектура;
- адаптивный UI;

## Архитектура проекта

В проекте используется архитектурный шаблон MVP (Model-View-Presenter).
Он разделяет приложение на три основных компонента:

- модель (Model) - представляет данные и бизнес-логику приложения;
- представление (View) - тображает данные пользователю и обрабатывает пользовательский ввод;
- презентер (Presenter) - правляет взаимодействием между моделью и представлением.

### Ключевые принципы

Изолированность: Каждый модуль работает независимо;
Единая ответственность: Четкое разделение на Model-View-Presenter;
Масштабируемость: Легко добавлять новые функции без изменения ядра;

## Базовые классы

### Класс ApiClient

Реализует при работе с API: отправку запросов, получение ответов, приведение полученных данных в массив, защиту от битых ссылок, формирование ссылок через CDN;

поля:

- private readonly baseUrl - базовый адрес сервера;
- private readonly cdnUrl - ссылка на коллекцию товаров;

конструктор:

- constructor(baseUrl: string = API_URL, cdnUrl: string = CDN_URL) - инициализирует клиент API устанавливая ссылки на сервер и коллекцию товара;

методы:

- async getProducts(): Promise<Product[]> - запрашивает список товаров и возвращает обработанные данные;
- private processProducts(items: any[]): Product[] - Преобразует сырые данные API в массив объектов;
- private processImageUrl(imageUrl?: string): string - Обрабатывает URL изображения, добавляя при необходимости cdnUrl;

### Класс EventEmitter

Брокер событий, централизованная система событий (реализует паттерн "Наблюдатель").

поля:

- _events - хранит подписки на события;

конструктор:

- constructor() - инициализирует карту _events;

методы:

- on - подписка на событие;
- off - отписывает от события;
- emit - инициирует событие;
- onAll - подписывает на все события;
- offAll - сбрасывает все подписки;
- trigger - возвращает функцию, которая при вызове инициирует событие;

### Класс

поля:

-  - ;
-  - ;

конструктор:

- constructor() - инициализирует ;

методы:

- ;
- ;
- ;

### Класс

поля:

-  - ;
-  - ;

конструктор:

- constructor() - инициализирует ;

методы:

- ;
- ;
- ;


### Класс

поля:

-  - ;
-  - ;

конструктор:

- constructor() - инициализирует ;

методы:

- ;
- ;
- ;

### Модели данных

interface IProduct {
  id: string;
  title: string;
  price: number | null; // null для "Бесценных" товаров
  category: string;
  description: string;
  image: string;
}

interface IOrder {
  items: string[];
  total: number;
  payment: 'card' | 'cash';
  address: string;
  email: string;
  phone: string;
}

### UI-компоненты

Компонент	    Ответственность	               События

ProductCard	  Отображение карточки товара	   addToCart, preview;
Basket	      Управление корзиной	           checkout, removeItem;
OrderForm	    Многошаговая форма заказа	     submit, validate;
Modal	        Управление модальными окнами	 open, close;

Пример ProductCard:

class ProductCard extends Component {
  constructor(product: IProduct) {
    super();
    this.render = () => `
      <div class="card">
        <span class="card__category">${product.category}</span>
        <h3 class="card__title">${product.title}</h3>
        <div class="card__price">${product.price ?? 'Бесценно'}</div>
      </div>
    `;
  }
}

### Взаимодействие компонентов

- Пользователь взаимодействует с View;
- View генерирует события через EventEmitter;
- Presenter обрабатывает события и обновляет Model;
- Model уведомляет об изменениях через EventEmitter;

## Типы данных

### Основные интерфейсы

// Состояние приложения
interface IAppState {
  products: IProduct[];
  basket: IProduct[];
  order: IOrder;
  loading: boolean;
  error: string | null;
}

// События
type AppEvents = {
  'basket:changed': IProduct[];
  'order:submitted': IOrder;
  'modal:opened': { type: string };
}

### API Endpoints

Метод	  Эндпоинт	 Описание

GET	    /products	 Получение списка товаров;
POST	  /orders	   Создание заказа;

Пример запроса:

class ApiClient {
  async getProducts(): Promise<IProduct[]> {
    const response = await fetch('/products');
    return this.handleResponse(response);
  }
}

## Функциональные требования

Главная страница:

- просмотр каталога товаров;
- фильтрация по категориям;
- поиск по названию;
- модальное окно с описанием товара;

Корзина:

- добавление/удаление товаров;
- изменение количества;
- расчёт итоговой суммы;

Оформление заказа:

- ввод адреса доставки;
- выботр способа оплаты;
- подтверждение заказа;
- товар с ценой 'null' ("Бесценно");
- валидация форм ввода;

Общие требования:

Модальные окна закрываются при клике вне модального окна, или по иконке «Закрыть», или по кнопке «На главную», если они есть.
Кнопка перехода к следующему шагу доступна только если действия на текущей странице выполнены (например, указание телефона и почты).